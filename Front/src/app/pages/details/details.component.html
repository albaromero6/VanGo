<div *ngIf="!loading && !error && vehicle" class="vehicle-detail">
    <div class="vehicle-detail__left">
        <div class="vehicle-detail__header">
            <div *ngIf="!editMode">
                <h1 class="vehicle-detail__title">{{ getVehicleName() }}</h1>
            </div>
            <div *ngIf="editMode && isAdmin" class="edit-fields">
                <input type="text" [(ngModel)]="vehicle.modelo.nombre" placeholder="Nombre modelo" class="edit-input" />
                <input type="number" [(ngModel)]="vehicle.precio" placeholder="Precio por día" class="edit-input" />
                <select [(ngModel)]="vehicle.combustible" class="edit-input">
                    <option value="GASOLINA">Gasolina</option>
                    <option value="DIESEL">Diésel</option>
                </select>
                <select [(ngModel)]="vehicle.transmision" class="edit-input">
                    <option value="MANUAL">Manual</option>
                    <option value="AUTOMATICO">Automático</option>
                </select>
                <input type="number" [(ngModel)]="vehicle.puertas" placeholder="Número de puertas" class="edit-input" />
                <input type="number" [(ngModel)]="vehicle.pasajeros" placeholder="Número de pasajeros"
                    class="edit-input" />
            </div>
            <div class="vehicle-detail__price" *ngIf="!editMode">
                <span class="vehicle-detail__price-amount">{{ vehicle.precio }}€<span
                        class="vehicle-detail__price-period">/día</span></span>
            </div>
        </div>

        <div class="vehicle-detail__main-image">
            <img [src]="getVehicleImage()" [alt]="getVehicleName()" (error)="onImageError($event)">
        </div>

        <div class="vehicle-detail__gallery" *ngIf="galleryImages.length > 0">
            <div class="vehicle-detail__gallery-item" *ngFor="let image of galleryImages; let i = index" #galleryItem
                (click)="openLightbox(i)">
                <img [src]="getGalleryImage(image)" [alt]="getVehicleName()" (error)="onImageError($event)">
            </div>
        </div>

        <div class="lightbox" *ngIf="showLightbox" (click)="closeLightbox()">
            <div class="lightbox__content" (click)="$event.stopPropagation()">
                <button class="lightbox__close" (click)="closeLightbox()"></button>
                <button class="lightbox__prev" (click)="prevImage()" *ngIf="currentImageIndex > 0">‹</button>
                <button class="lightbox__next" (click)="nextImage()"
                    *ngIf="currentImageIndex < galleryImages.length - 1">›</button>
                <img [src]="getGalleryImage(galleryImages[currentImageIndex])" [alt]="getVehicleName()">
            </div>
        </div>

        <button class="vehicle-detail__button" (click)="reservar()" *ngIf="!editMode">Reservar</button>

        <div *ngIf="editMode && isAdmin" class="edit-actions">
            <button class="edit-button save" (click)="guardarCambios()">Guardar cambios</button>
            <button class="edit-button cancel" (click)="cancelarEdicion()">Cancelar</button>
        </div>
    </div>

    <div class="vehicle-detail__right">
        <div class="vehicle-detail__specs">
            <div class="vehicle-detail__specs-item">
                <div class="vehicle-detail__specs-icon">
                    <img src="assets/img/Combustible.png" alt="Combustible">
                </div>
                <div class="vehicle-detail__specs-content">
                    <p *ngIf="!editMode">{{ formatCombustible(vehicle.combustible) }}</p>
                    <select *ngIf="editMode" [(ngModel)]="vehicle.combustible" class="edit-input">
                        <option value="GASOLINA">Gasolina</option>
                        <option value="DIESEL">Diésel</option>
                    </select>
                </div>
            </div>
            <div class="vehicle-detail__specs-item">
                <div class="vehicle-detail__specs-icon">
                    <img src="assets/img/Transmision.png" alt="Transmisión">
                </div>
                <div class="vehicle-detail__specs-content">
                    <p *ngIf="!editMode">{{ formatTransmision(vehicle.transmision) }}</p>
                    <select *ngIf="editMode" [(ngModel)]="vehicle.transmision" class="edit-input">
                        <option value="MANUAL">Manual</option>
                        <option value="AUTOMATICO">Automático</option>
                    </select>
                </div>
            </div>
            <div class="vehicle-detail__specs-item">
                <div class="vehicle-detail__specs-icon">
                    <img src="assets/img/Puertas.png" alt="Puertas">
                </div>
                <div class="vehicle-detail__specs-content">
                    <p *ngIf="!editMode">{{ vehicle.puertas }}</p>
                    <input *ngIf="editMode" type="number" [(ngModel)]="vehicle.puertas" class="edit-input" />
                </div>
            </div>
            <div class="vehicle-detail__specs-item">
                <div class="vehicle-detail__specs-icon">
                    <img src="assets/img/Pasajeros.png" alt="Pasajeros">
                </div>
                <div class="vehicle-detail__specs-content">
                    <p *ngIf="!editMode">{{ vehicle.pasajeros }}</p>
                    <input *ngIf="editMode" type="number" [(ngModel)]="vehicle.pasajeros" class="edit-input" />
                </div>
            </div>
        </div>

        <div class="vehicle-detail__equipment">
            <div class="vehicle-detail__equipment-grid">
                <div class="vehicle-detail__equipment-item">
                    <span class="vehicle-detail__equipment-check">✓</span>
                    <span class="vehicle-detail__equipment-text">Aire acondicionado</span>
                </div>
                <div class="vehicle-detail__equipment-item">
                    <span class="vehicle-detail__equipment-check">✓</span>
                    <span class="vehicle-detail__equipment-text">Bluetooth</span>
                </div>
                <div class="vehicle-detail__equipment-item">
                    <span class="vehicle-detail__equipment-check">✓</span>
                    <span class="vehicle-detail__equipment-text">GPS</span>
                </div>
                <div class="vehicle-detail__equipment-item">
                    <span class="vehicle-detail__equipment-check">✓</span>
                    <span class="vehicle-detail__equipment-text">Radio</span>
                </div>
                <div class="vehicle-detail__equipment-item">
                    <span class="vehicle-detail__equipment-check">✓</span>
                    <span class="vehicle-detail__equipment-text">USB</span>
                </div>
                <div class="vehicle-detail__equipment-item">
                    <span class="vehicle-detail__equipment-check">✓</span>
                    <span class="vehicle-detail__equipment-text">Volante multifunción</span>
                </div>
                <div class="vehicle-detail__equipment-item">
                    <span class="vehicle-detail__equipment-check">✓</span>
                    <span class="vehicle-detail__equipment-text">Cámara trasera</span>
                </div>
                <div class="vehicle-detail__equipment-item">
                    <span class="vehicle-detail__equipment-check">✓</span>
                    <span class="vehicle-detail__equipment-text">Panel solar</span>
                </div>
                <div class="vehicle-detail__equipment-item">
                    <span class="vehicle-detail__equipment-check">✓</span>
                    <span class="vehicle-detail__equipment-text">Calefacción estacionaria</span>
                </div>
            </div>
        </div>
    </div>
</div>